<% include partials/header %>

<div class="container">

<div class="row">
  <div class="col-12">

    <!-- Nav pills -->
    <ul class="nav nav-pills nav-justified">
      <li class="nav-item">
        <a class="nav-link active text-dark" data-toggle="pill" href="#fanTheories">Fan Theories</a>
      </li>
      <li class="nav-item">
        <a class="nav-link  text-dark" data-toggle="pill" href="#fanFictions">Fan Fictions</a>
      </li>
      <li class="nav-item">
        <a class="nav-link  text-dark" data-toggle="pill" href="#qna">Q-N-A</a>
      </li>
    </ul>

<br>


  </div>
</div>

<div class="row">
  <div class="col-12">

    <!-- Tab panes -->
    <div class="tab-content">

      <div class="tab-pane active container" id="fanTheories">

        <!---->


        <!---->

        <button class="btn btn-primary" id="filter">Filter by category</button>
        <br>

        <div id="filterOptions">
        <form method= 'POST' action= '/fanTheories/filtered'>
          <div class="form-check">
            <label class="form-check-label">
              <input type="checkbox" class="form-check-input" value="Game of thrones" name="filterCheckbox">Game of thrones
            </label>
          </div>
          <div class="form-check">
            <label class="form-check-label">
              <input type="checkbox" class="form-check-input" value="Harry Potter" name="filterCheckbox">Harry Potter
            </label>
          </div>
          <div class="form-check disabled">
            <label class="form-check-label">
              <input type="checkbox" class="form-check-input" value="Marvel" name="filterCheckbox">Marvel
            </label>
          </div>
          <div class="form-check disabled">
            <label class="form-check-label">
              <input type="checkbox" class="form-check-input" value="DC" name="filterCheckbox">DC
            </label>
          </div>
          <div class="form-check disabled">
            <label class="form-check-label">
              <input type="checkbox" class="form-check-input" value="F.R.I.E.N.D.S." name="filterCheckbox">F.R.I.E.N.D.S.
            </label>
          </div>
          <div class="form-check disabled">
            <label class="form-check-label">
              <input type="checkbox" class="form-check-input" value="How I met your mother" name="filterCheckbox">How I met your mother
            </label>
          </div>
          <div class="form-check disabled">
            <label class="form-check-label">
              <input type="checkbox" class="form-check-input" value="The Big Bang Theory" name="filterCheckbox">The Big Bang Theory
            </label>
          </div>
          <div class="form-check disabled">
            <label class="form-check-label">
              <input type="checkbox" class="form-check-input" value="Lord of the rings" name="filterCheckbox">Lord of the rings
            </label>
          </div>
          <div class="form-check disabled">
            <label class="form-check-label">
              <input type="checkbox" class="form-check-input" value="Narnia" name="filterCheckbox" >Narnia
            </label>
          </div>
          <div class="form-check disabled">
            <label class="form-check-label">
              <input type="checkbox" class="form-check-input" value="Star Wars" name="filterCheckbox" >Star Wars
            </label>
          </div>
          <div class="form-check disabled">
            <label class="form-check-label">
              <input type="checkbox" class="form-check-input" value="Star Trek" name="filterCheckbox" >Star Trek
            </label>
          </div>
          <div class="form-check disabled">
            <label class="form-check-label">
              <input type="checkbox" class="form-check-input" value="James Bond" name="filterCheckbox" >James Bond
            </label>
          </div>
          <div class="form-check disabled">
            <label class="form-check-label">
              <input type="checkbox" class="form-check-input" value="Sherlock Holmes" name="filterCheckbox" >Sherlock Holmes
            </label>
          </div>
          <div class="form-check disabled">
            <label class="form-check-label">
              <input type="checkbox" class="form-check-input" value="Other" name="filterCheckbox" >Other
            </label>
          </div>

          <input class="btn btn-primary" type="submit" value="Apply">
        </form>
      </div>



        <ul class="list-group">
          <% let flag = 1 %>
          <% fanTheories.forEach(function(fanTheory){ %>
            <% let link = "/fanTheories/details/" + fanTheory._id.toString() %>
            <li class="list-group-item"><!--<a href="<%=link%>">-->
              <h1><%= fanTheory.title %></h1>
              <h5>Category : <%=fanTheory.category%></h5>
              <hr>
                <% let x = 'half half' + flag %>
                <% let y = 'full full' + flag %>
                <% flag++ %>
                <div class="<%= x %>">
                  <p><%= fanTheory.body.slice(0, 5) + '...' %> </p>
                </div>
                <div class="<%= y %>">
                  <p><%= fanTheory.body %></p>
                  <p>Author - <%= fanTheory.author %></p>
                  <hr>
                  <h3>Comments</h3>
                  <br>
                  <% let acn = "/fanTheories/addComment/" + fanTheory._id; %>
                  <% console.log(acn); %>
                  <form method= 'POST' action= '<%=acn%>'>
                    <div id="form-group">
                      <textarea class="form-control" name="comment" placeholder="Type your comment.."></textarea>
                    </div>
                    <br>
                    <input class="btn btn-primary" type="submit" value="Post">
                  </form>

                  <br>
                  <ul class="list-group">
                    <% fanTheory.comments.forEach(function(comment){ %>
                      <li class="list-group-item"><%=comment.usr%> - <%=comment.msg%></li>
                    <% }); %>
                  </ul>
                </div>
                <br>
                <button class="btn btn-primary readMoreBtn" data-id="<%= flag %>">Read more</button>
            <!--</a>--></li>
          <% }) %>
        </ul>
        <br>
        <ul class="pagination">
          <% let cls, link; %>
          <% if(page == 1){ %>
            <% cls = "page-item disabled"; %>
            <% link = "#"; %>
          <% } else { %>
            <% cls = "page-item"; %>
            <% link = "/fanTheories/page/" + (Number(page) - 1); %>
          <% } %>
          <li class="<%=cls%>"><a class="page-link" href="<%=link%>">Previous</a></li>

          <% for(let i = 1; i <= totalPages; i++){ %>
            <% console.log("i" + i); %>
            <% console.log("page" + page); %>
            <% if(i == page){ %>
              <% console.log("hi"); %>
              <%cls = "page-item active";%>
              <% console.log("hii"); %>
            <% } else { %>
              <% console.log("not equal"); %>
              <%cls = "page-item";%>
            <% } %>
            <% link = "/fanTheories/page/" + i; %>
            <li class="<%=cls%>"><a class="page-link" href="<%=link%>"><%=i%></a></li>
          <% } %>

          <% if(page == totalPages){ %>
            <% cls = "page-item disabled"; %>
            <% link = "#"; %>
          <% } else { %>
            <% cls = "page-item"; %>
            <% link = "/fanTheories/page/" + (Number(page) + 1); %>
          <% } %>

          <li class="<%=cls%>"><a class="page-link" href="<%=link%>">Next</a></li>


        </ul>

      </div>

      <div class="tab-pane container" id="fanFictions">Fan Fictions</div>
      <div class="tab-pane container" id="qna">QNA</div>

    </div>

  </div>

</div>

</div>
</div>

<% include partials/footer %>
